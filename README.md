Ликвидно-взвешенный трендовый индикатор (LWTI)
==============================================

Описание
--------
Проект демонстрирует построение и оценку кастомного торгового индикатора LWTI (Liquidity Weighted Trend Indicator). Индикатор усиливает вклад баров с повышенным объёмом, сглаживает цену через экспоненциальное усреднение и выдаёт направления `long` / `short` / `flat` на основе сравнений тренда и волатильности.

Функциональные требования
- Импорт свечей из CSV: `timestamp,open,high,low,close,volume` с автоматическим пропуском некорректных строк.
- Расчёт LWTI по конфигурируемым окнам: трендовое сглаживание, окно волатильности, плечо объёма, порог генерации сигналов.
- Генерация сигналов (`long`/`short`/`flat`) и вывод таблицы в stdout или файл.
- Минимальная аналитика: вывод последних значений тренда, импульса и волатильности.
- Тестовая среда: модульные тесты на вычисления и реакцию на изменения объёма/цены.

Технические требования
- C++20, сборка через CMake 3.20+.
- Структура: библиотека с расчётом индикатора, консольный инструмент, модульные тесты (Catch2 single-header в репозитории).
- Документация: короткие комментарии в коде, README с требованиями и архитектурой.
- Входные данные: CSV в локальной файловой системе; зависимости только из репозитория.

Требования к производительности
- Расчёт индикатора должен обрабатывать ≥1e6 баров менее чем за 1.5 секунды на современной CPU (≈3.0 GHz, single-thread), для типовой конфигурации окон ≤64.
- 80% типовых запросов (запуск cli на файле до 200k баров) должны выполняться <0.5 секунды.
- Память: <200 MB на массив из 1e6 баров.

Архитектура
- `indicator`: чистая библиотека, обрабатывает `std::vector<Candle>` и возвращает `IndicatorPoint` с трендом, импульсом и сигналом. Внутри используются инкрементальные суммы и дисперсия по окну.
- `io`: разбор CSV, нормализация данных и безопасное чтение с пропуском невалидных строк.
- `cli`: тонкий слой поверх библиотеки, парсинг флагов, печать результатов.
- `tests`: покрывают расчёт тренда, реакцию на объём и генерацию сигналов.

Логика индикатора
- Типичная цена: `(high + low + close) / 3`.
- Взвешенный EMA по типичной цене с коэффициентом `alpha = 2/(N+1)` и динамическим весом `min(1, alpha * weight)` для усиления баров с объёмом выше среднего.
- Импульс: относительное изменение сглаженной цены за `momentum_lookback`.
- Волатильность: скользящее стандартное отклонение доходностей типичной цены.
- Сигнал: `long`, если импульс превышает `volatility * threshold`; `short`, если ниже `-volatility * threshold`; иначе `flat`.

Сборка и запуск
```bash
cmake -S . -B build -DCMAKE_BUILD_TYPE=Release
cmake --build build
./build/bin/lwti --input data/sample.csv --output stdout
```

Параметры CLI
- `--input <path>` — CSV с OHLCV.
- `--output <path|stdout>` — путь для результата или `stdout`.
- `--trend-period N` — окно EMA.
- `--momentum-lookback N` — лаг для импульса.
- `--volatility-window N` — окно для волатильности доходностей.
- `--threshold X` — множитель волатильности для фильтра сигналов.
- `--volume-floor X` — минимальный вес бара.

Краткий пример вывода
```
timestamp,close,lw_ema,momentum,volatility,signal
2023-01-01T10:00:00Z,101.2,101.2,0.0000,0.0000,flat
...
2023-01-01T10:09:00Z,105.1,104.4,0.0175,0.4200,long
```

Структура репозитория
- `include/` — публичный интерфейс индикатора.
- `src/` — реализация библиотеки и CLI.
- `tests/` — модульные тесты и Catch2.
- `data/` — пример CSV для быстрой проверки.
